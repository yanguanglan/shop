KISSY.add("list-m/widgets/follower",function(e,t,i,s,o){var n=window,r=s.ie==6;var l={tb:{offset:"top",scroll:"scrollTop",delta:"deltaY"},lr:{offset:"left",scroll:"scrollLeft",delta:"deltaX"}};function a(e){a.superclass.constructor.call(this,e||{});this._init()}e.extend(a,o,{_init:function(){var e=this.get("selector"),s=t.get(e);if(!s)return;var o=this.get("placeholder"),r=t.get(o);if(!r){var a={css:{height:t.outerHeight(s,true),display:"none"}},d="div";switch(o.replace(/\s/g,"").charAt(0)){case".":a.class=o.substr(1);break;case"#":a.id=o.substr(1);break;default:d=o;break}r=t.create("<"+d+"/>",a);t.insertAfter(r,s)}var u,c=l[this.get("orientation")];var m={};i.on(n,"touchstart",function(e){var t=e.touches[0];m.x=t.pageX;m.y=t.pageY});i.on(n,"touchmove",function(e){var t=e.touches[0];u=(c["delta"]==="deltaX"?t.pageX-m.x:t.pageY-m.y)>0});var f=this.get("fixClass"),g=this.get("positiveClass"),h=this.get("negativeClass"),p=this.get("tolerance"),v=this.get("refNode"),w=t.hasClass(s,f)?t.offset(r)[c["offset"]]:t.offset(s)[c["offset"]],x=t[c["scroll"]],b,S=this._follow=function(){if(LIST.msg.get("fixed.stop")){return}var e=u?h:g,i=x(v);if(i-w-p>0){if(!b){t.addClass(s,f);t.show(r);b=true}t.removeClass(s,g+" "+h);t.addClass(s,e)}else{t.removeClass(s,f+" "+g+" "+h);t.hide(r);b=false}};S();i.on(n,"scroll.follow",S)},follow:function(){this._follow&&this._follow()},destroy:function(){var e=this.get("selector"),s=t.get(e),o=this.get("fixClass"),r=this.get("positiveClass"),l=this.get("negativeClass");s&&t.removeClass(s,o+" "+r+" "+l);i.detach(n,"scroll",this._follow);this._follow=null;this.set("selector","")}},{ATTRS:{selector:{value:""},placeholder:{value:"",setter:function(t){return t&&typeof t==="string"?e.trim(t).replace(/[<>@&$~^*()%]/g,""):"#J_Placeholder_"+(new Date).getTime()}},fixClass:{value:"follow-fixed"},positiveClass:{value:"follow-positive"},negativeClass:{value:"follow-negative"},tolerance:{value:0,setter:function(e){return typeof e==="number"?e||0:0}},orientation:{value:"tb"},refNode:{value:n}}});return a},{requires:["dom","event","ua","base"]});