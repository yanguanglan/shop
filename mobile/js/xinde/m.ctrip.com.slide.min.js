void function(c){var n="slide-nav-item-current",o="slide-nav-item",m="error",j=null,h="img",b="px",l="slide-img-item",f=".",e="</div>",d='<div class="',i=true,k="left",g=false,s=Object.prototype.toString,p={},a={config:{prefix:"cui-"},Tools:{getElementPos:function(a){var c=0,b=0;do{c+=a.offsetTop;b+=a.offsetLeft}while(a=a.offsetParent);return{top:c,left:b}},getMousePos:function(a){var c=Math.max(document.body.scrollTop,document.documentElement.scrollTop),b=Math.max(document.body.scrollLeft,document.documentElement.scrollLeft);return{top:c+a.clientY,left:b+a.clientX}},getMousePosOfElement:function(i,d){var e=a.Tools.getMousePos(i),f=a.Tools.getElementPos(d),h=d.clientWidth,g=d.clientHeight,b=e.left-f.left,c=e.top-f.top;b=b<0?0:b>h?h:b;c=c<0?0:c>g?g:c;return{x:b,y:c}}}};function q(c,b){if(typeof c==="object"){b=c;c=function(){}}var j=c.prototype,i=function(){},a=function(){this.__propertys__();this.initialize.apply(this,arguments)},h,g,f,e,d;i.prototype=j;a.prototype=new i;a.prototype.constructor=c;f=a.prototype.initialize||function(){};e=b.initialize||function(){};h=a.prototype.__propertys__||function(){};g=b.__propertys__||function(){};var k=/^\s*function\s*\(([^\(\)]*?)\)\s*?\{/i.exec(e.toString())[1].replace(/\s/i,"").split(",");for(d in b)b.hasOwnProperty(d)&&(a.prototype[d]=b[d]);if(arguments.length>0&&arguments[0].prototype&&arguments[0].prototype.initialize===f)a.prototype.initialize=function(){var b=this,a=[function(){f.apply(b,arguments)}];e.apply(this,a.concat(slice.call(arguments)))};a.prototype.__propertys__=function(){h.call(this);g.call(this)};return a}p.Class=q;var r=new p.Class({__propertys__:function(){var a=this;a.images=[];a.index=1;a.delay=3;a.defaultIndex;a.autoplay=g;a.root;a.imageinter;a.imageouter;a.navbox;a.navs;a.navinter;a.container;a.interWidth;a.itemWidth;a.ENUM_STATE_EMPTY=0;a.ENUM_STATE_NOTEMPTY=1;a.state=a.ENUM_STATE_EMPTY;a.notimagedom;a.setTimeoutResoure;a.isMove=g;a.dirs={left:"next",right:"pre"};a.dir=k;a.startX=0;a.startY=0;a.onerror=function(){};a.preventDefault=i},initialize:function(b){var a=this;a.setOption(b);a.createLayout();a.addImageItems();setTimeout(c.proxy(function(){var a=this;a.calcinterWidth();if(a.state===a.ENUM_STATE_NOTEMPTY){a.initposition();a.autoplay&&a.play();a.images&&a.images.length>1&&a.buildEvent()}},a),1)},setOption:function(b){for(var a in b)switch(a){case"autoplay":case"defaultIndex":case"container":case"notimage":case"delay":case"dir":case"onerror":case"preventDefault":this[a]=b[a];break;case"images":if(b[a]&&typeof b[a][0]==="string"){for(var d=[],c=0,e=b[a].length;c<e;c++)d.push({src:b[a][c]});this[a]=d}else this[a]=b[a]}},initposition:function(){var a=this;a.go(a.index,function(){},i);var b=a.calcNextIndex();a.setNavCurrent(b)},createLayout:function(){var b=this;b.root=c([d+a.config.prefix+'slide">',d+a.config.prefix+'slide-imgsouter">',d+a.config.prefix+'slide-imgsinter">',e,e,d+a.config.prefix+'slide-nav">',d+a.config.prefix+'slide-nav-padding">',e,e,e].join(""));b.imageouter=b.root.find(f+a.config.prefix+"slide-imgsouter");b.imageinter=b.root.find(f+a.config.prefix+"slide-imgsinter");b.navbox=b.root.find(f+a.config.prefix+"slide-nav");b.navinter=b.root.find(f+a.config.prefix+"slide-nav-padding");b.container.empty().append(b.root)},calcinterWidth:function(){var d=this,g=d.imageinter.find(f+a.config.prefix+l),e=0;d.interWidth=e;d.itemWidth=d.imageouter.width();g.css("width",d.itemWidth+b);g.each(function(){e+=c(this).width()});d.imageinter.css("width",e+b);var h=(d.index-1)*d.itemWidth;d.imageinter.css({left:-h+b});d.stop();clearTimeout(d.resizere);d.resizere=setTimeout(c.proxy(function(){this.play()},d),100)},resetSize:function(){var a=this;this.setHeightTimer=setInterval(function(){var c=a.imageinter.find(h).height();if(c>0){a.container.css("height",c+b);clearInterval(a.setHeightTimer)}},100)},windowResize:function(){var a=this;c(window).resize(function(){a.calcinterWidth();a.resetSize()})},createImageItem:function(b,m,h){var g=[a.config.prefix+l];m&&g.push(a.config.prefix+"slide-img-item-current");h&&[].push.call(g,h);if(b&&b.link&&(b.link.indexOf("car.ctrip.com/carbooking")>-1||b.link.indexOf("car.test.sh.ctriptravel.com/carbooking")>-1)){var j=ctripmobi.utils;if(j){var f=j.getUserInfo();if(f&&f.data&&f.data.IsNonUser!=i){var k=f.data.Auth;if(b.link.indexOf("?")>-1)b.link+="&result="+k;else b.link+="?result="+k}}}var n=c([d+g.join(" ")+'">','<a href="'+(b.link?b.link:"javascript:void(0);")+'"><img src="'+b.src+'" title="'+(b.title||"")+'"/></a>',e].join(""));return n},addEmptyItem:function(){var b=[a.config.prefix+l,a.config.prefix+"slide-img-item-empey"];this.notimagedom=c(d+b.join(" ")+'"></div>');this.imageinter.append(this.notimagedom)},addImageItems:function(){var b=this;for(var d=0,g=b.images.length,i;d<g;d++)b.addItem(b.images[d],b.defaultIndex===d);var c,e;if(b.images.length){b.state=b.ENUM_STATE_NOTEMPTY;c=b.createImageItem(b.images[0],j,[a.config.prefix+"slide-img-pre"]);e=b.createImageItem(b.images[Math.max(0,b.images.length-1)],j,[a.config.prefix+"slide-img-last"]);c.find(h).bind(m,b.onerror);c[0]!==e[0]&&c.find(h).bind(m,b.onerror);b.imageinter.append(c);b.imageinter.prepend(e);b.navs=b.navinter.find(f+a.config.prefix+o)}else{b.state=b.ENUM_STATE_EMPTY;b.addEmptyItem(b.notimage)}},buildEvent:function(){var a=this;a.imageouter.bind("touchstart",c.proxy(a.onTouchStart,a));a.imageouter.bind("touchmove",c.proxy(a.onTouchMove,a));a.imageouter.bind("touchend",c.proxy(a.onTouchEnd,a));a.imageouter.bind("touchcancel",c.proxy(a.onTouchEnd,a))},onTouchStart:function(c){var b=this;b.preventDefault&&c.preventDefault();if(b.isMove){b.isTouchStart=g;return}b.isTouchStart=i;var d=a.Tools.getMousePosOfElement(c.targetTouches[0],c.currentTarget);b.stop();b.startX=d.x;b.startY=d.y;b.imageinterLeft=parseInt(b.imageinter.css(k))},onTouchMove:function(d){var c=this;d.preventDefault();if(c.isMove||!c.isTouchStart)return;var e=a.Tools.getMousePosOfElement(d.targetTouches[0],d.currentTarget),f=e.x-c.startX,g=e.y-c.startY;c.imageinter.css(k,c.imageinterLeft+f+b)},onTouchEnd:function(f){var d=this;d.preventDefault&&f.preventDefault();if(d.isMove||!d.isTouchStart)return;var h=a.Tools.getMousePosOfElement(f.changedTouches[0],f.currentTarget),g=h.x-d.startX,i=h.y-d.startY,e=c.proxy(function(){this.play()},d);if(g>50)d.pre(e);else if(g<-50)d.next(e);else d.imageinter.animate({left:d.imageinterLeft+b},j,e)},createNavItem:function(b){return c(['<span class="'+a.config.prefix+o+(b?a.config.prefix+n:"")+'"></span>'].join(""))},addItem:function(e,b){var a=this,c=a.createImageItem(e,b),d=a.createNavItem(b);typeof a.onerror==="function"&&c.find(h).bind(m,a.onerror);a.imageinter.append(c);a.navinter.append(d)},play:function(){var a=this;clearInterval(a.setTimeoutResoure);if(!a.images||a.images.length<2)return;a.setTimeoutResoure=setInterval(c.proxy(a[a.dirs[a.dir]],a),a.delay*1e3)},stop:function(){clearInterval(this.setTimeoutResoure)},go:function(h,d,f){var a=this;a.isMove=i;var e=-(a.itemWidth*h);if(f){a.imageinter.css({left:e+b});a.isMove=g;d&&d()}else a.imageinter.animate({left:e+b},j,j,c.proxy(function(){this.isMove=g;d&&d()},a))},next:function(a){this.go(++this.index,c.proxy(function(){var c=this;if(c.index===c.images.length+1){c.index=1;var d=-(c.itemWidth*c.index);c.imageinter.css({left:d+b})}var e=c.calcNextIndex();c.setNavCurrent(e);a&&a()},this))},setNavCurrent:function(b){this.navs.removeClass(a.config.prefix+n);c(this.navs.get(b)).addClass(a.config.prefix+n)},calcNextIndex:function(){return this.index>this.images.length?0:this.index-1},pre:function(d){var a=this;a.index==0&&(a.index=1);a.go(--a.index,c.proxy(function(){var a=this;if(a.index===0){a.index=a.images.length;var c=-(a.itemWidth*a.index);a.imageinter.css({left:c+b})}var e=a.calcPreIndex();a.setNavCurrent(e);d&&d()},a))},calcPreIndex:function(){return this.index<1?Math.max(0,this.images.length-1):this.index-1},empty:function(){this.stop();this.imageinter.find(h).remove()}});window.CUISlide=r}($);